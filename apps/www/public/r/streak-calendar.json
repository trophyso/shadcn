{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "streak-calendar",
  "type": "registry:ui",
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "components/ui/streak-calendar.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { Snowflake } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\n// Types (inlined)\ninterface StreakPeriod {\n  periodStart: string;\n  periodEnd: string;\n  length: number;\n  usedFreeze?: boolean;\n}\n\ninterface StreakResponse {\n  length: number;\n  frequency: \"daily\" | \"weekly\" | \"monthly\";\n  started: string | null;\n  periodStart: string | null;\n  periodEnd: string | null;\n  expires: string | null;\n  streakHistory: StreakPeriod[];\n  rank: number | null;\n  freezes?: number;\n  maxFreezes?: number;\n}\n\n// Helper to check if a date falls within a streak period\nfunction isDateInPeriod(date: Date, period: StreakPeriod): boolean {\n  const d = date.toISOString().split(\"T\")[0];\n  return d >= period.periodStart && d <= period.periodEnd;\n}\n\n// Helper to check if date used a freeze\nfunction didUseFreezeOnDate(date: Date, periods: StreakPeriod[]): boolean {\n  for (const period of periods) {\n    if (isDateInPeriod(date, period) && period.usedFreeze) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// Helper to check if date was active in streak\nfunction wasDateActive(date: Date, periods: StreakPeriod[]): boolean {\n  for (const period of periods) {\n    if (isDateInPeriod(date, period)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// Get days in month\nfunction getDaysInMonth(year: number, month: number): number {\n  return new Date(year, month + 1, 0).getDate();\n}\n\n// Get day of week for first day of month (0 = Sunday)\nfunction getFirstDayOfMonth(year: number, month: number): number {\n  return new Date(year, month, 1).getDay();\n}\n\n// Props\ninterface StreakCalendarProps extends React.HTMLAttributes<HTMLDivElement> {\n  /** Trophy API streak response (must include streakHistory) */\n  streak: StreakResponse;\n  /** Month to display (default: current month) */\n  month?: Date;\n  /** Show freeze indicators */\n  showFreezes?: boolean;\n  /** Start of week: 0 = Sunday, 1 = Monday */\n  startOfWeek?: 0 | 1;\n  /** Callback when a day is clicked */\n  onDayClick?: (date: Date, wasActive: boolean) => void;\n}\n\nconst WEEKDAYS_SUNDAY = [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"];\nconst WEEKDAYS_MONDAY = [\"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"];\n\nconst StreakCalendar = React.forwardRef<HTMLDivElement, StreakCalendarProps>(\n  (\n    {\n      className,\n      streak,\n      month = new Date(),\n      showFreezes = true,\n      startOfWeek = 0,\n      onDayClick,\n      ...props\n    },\n    ref,\n  ) => {\n    const year = month.getFullYear();\n    const monthIndex = month.getMonth();\n    const daysInMonth = getDaysInMonth(year, monthIndex);\n    const firstDayOfMonth = getFirstDayOfMonth(year, monthIndex);\n\n    // Adjust first day based on start of week preference\n    const adjustedFirstDay =\n      startOfWeek === 1\n        ? (firstDayOfMonth + 6) % 7 // Monday start\n        : firstDayOfMonth; // Sunday start\n\n    const weekdays = startOfWeek === 1 ? WEEKDAYS_MONDAY : WEEKDAYS_SUNDAY;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    const periods = streak.streakHistory ?? [];\n\n    // Generate calendar days\n    const days: (number | null)[] = [];\n\n    // Add empty cells for days before the first of the month\n    for (let i = 0; i < adjustedFirstDay; i++) {\n      days.push(null);\n    }\n\n    // Add days of the month\n    for (let day = 1; day <= daysInMonth; day++) {\n      days.push(day);\n    }\n\n    const monthName = month.toLocaleDateString(\"en-US\", { month: \"long\" });\n\n    return (\n      <div ref={ref} className={cn(\"w-full max-w-sm\", className)} {...props}>\n        {/* Header */}\n        <div className=\"mb-4 text-center\">\n          <h3 className=\"text-lg font-semibold\">\n            {monthName} {year}\n          </h3>\n        </div>\n\n        {/* Weekday headers */}\n        <div className=\"mb-2 grid grid-cols-7 gap-1\">\n          {weekdays.map((day) => (\n            <div\n              key={day}\n              className=\"text-center text-xs font-medium text-muted-foreground\"\n            >\n              {day}\n            </div>\n          ))}\n        </div>\n\n        {/* Calendar grid */}\n        <div className=\"grid grid-cols-7 gap-1\">\n          {days.map((day, index) => {\n            if (day === null) {\n              return <div key={`empty-${index}`} className=\"aspect-square\" />;\n            }\n\n            const date = new Date(year, monthIndex, day);\n            const isToday = date.getTime() === today.getTime();\n            const isFuture = date > today;\n            const isActive = wasDateActive(date, periods);\n            const usedFreeze = showFreezes && didUseFreezeOnDate(date, periods);\n\n            return (\n              <button\n                key={day}\n                type=\"button\"\n                onClick={() => onDayClick?.(date, isActive)}\n                disabled={isFuture}\n                className={cn(\n                  \"relative aspect-square flex items-center justify-center rounded-md text-sm transition-colors\",\n                  \"hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\",\n                  isToday && \"ring-2 ring-primary\",\n                  isFuture && \"text-muted-foreground/50 cursor-not-allowed\",\n                  isActive &&\n                    !usedFreeze &&\n                    \"bg-orange-500 text-white hover:bg-orange-600\",\n                  usedFreeze && \"bg-blue-500 text-white hover:bg-blue-600\",\n                )}\n              >\n                {day}\n                {usedFreeze && (\n                  <Snowflake className=\"absolute -top-1 -right-1 h-3 w-3 text-blue-200\" />\n                )}\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Legend */}\n        <div className=\"mt-4 flex items-center justify-center gap-4 text-xs text-muted-foreground\">\n          <div className=\"flex items-center gap-1\">\n            <div className=\"h-3 w-3 rounded bg-orange-500\" />\n            <span>Active</span>\n          </div>\n          {showFreezes && (\n            <div className=\"flex items-center gap-1\">\n              <div className=\"h-3 w-3 rounded bg-blue-500\" />\n              <span>Freeze used</span>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  },\n);\nStreakCalendar.displayName = \"StreakCalendar\";\n\nexport { StreakCalendar };\nexport type { StreakCalendarProps, StreakResponse, StreakPeriod };\n",
      "type": "registry:ui"
    }
  ]
}